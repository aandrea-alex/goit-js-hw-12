{"version":3,"file":"commonHelpers.js","sources":["../src/img/bi-x-octagon.svg","../src/img/icons.svg","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__005e8834__\"","export default \"__VITE_ASSET__0c78aa03__\"","import axios from 'axios';\n\nconst API_URL = 'https://pixabay.com/api/';\nconst API_KEY = '45097431-2d8d6a9f4785bbcc4049d8cdd';\n\nasync function getImages(strForSearch, pageNumber = 1) {\n  const apiParams = {\n    key: API_KEY,\n    q: strForSearch,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pageNumber,\n    per_page: 15,\n  };\n\n  try {\n    const response = await axios.get(API_URL, { params: apiParams });\n    const data = response.data;\n\n    if (!data.hits.length) {\n      return Promise.reject(\n        'Sorry, there are no images matching your search query. Please, try again!'\n      );\n    }\n    return Promise.resolve(data);\n  } catch (error) {\n    console.error('Error:', error);\n    throw new Error(`Failed to fetch data: ${error.message}`);\n  }\n}\n\nexport default getImages;\n\n","const cardMarkup = card => {\n  const { largeImageURL, previewURL, tags, likes, views, comments, downloads } =\n    card;\n\n  return `<li class='card'> \n              <a class='card-link' href='${largeImageURL}'>                    \n                <div class='card-cover-inner'>                \n                    <img class='card-cover'\n                        src='${previewURL}'\n                        alt='${tags}'                                                          \n                    />                                                  \n                  <div class='card-cover-darkened'></div>\n                </div>\n              </a>                 \n              <div class=\"card-info\">\n                  <div class=\"field\">\n                      <span class=\"label\">Likes</span>\n                      <span class=\"value\">${likes}</span>    \n                  </div>\n                  <div class=\"field\">\n                      <span class=\"label\">Views</span>\n                      <span class=\"value\">${views}</span>   \n                  </div>\n                  <div class=\"field\">\n                      <span class=\"label\">Comments</span>\n                      <span class=\"value\">${comments}</span>    \n                  </div>\n                  <div class=\"field\">\n                      <span class=\"label\">Downloads</span>\n                      <span class=\"value\">${downloads}</span>    \n                  </div>\n              </div>\n          </li>`;\n};\n\nfunction createCardsMarkup(cards) {\n  return cards.map(cardMarkup).join('');\n}\n\nfunction createCadsGallery(cardsArray, galleryRef) {\n  const cardsMarkup = createCardsMarkup(cardsArray);\n  galleryRef.innerHTML = '';\n  galleryRef.insertAdjacentHTML('beforeend', cardsMarkup);\n}\n\nexport async function scrollingDown() {\n  const cards = document.querySelectorAll('.gallery li');\n  if (cards.length === 0) return;\n  try {\n    window.scroll({ top: 0, left: 0 });\n    const gallery = document.querySelector('.gallery');\n    const cardHeight = gallery.firstChild.getBoundingClientRect().height;\n    const offset = 48;\n    window.scrollBy({\n      top: gallery.getBoundingClientRect().top + offset,\n      behavior: 'smooth',\n    });\n\n    let targetPosition = gallery.getBoundingClientRect().top + offset;\n\n    while (\n      targetPosition <\n      gallery.getBoundingClientRect().bottom - cardHeight - offset\n    ) {\n      targetPosition += cardHeight + offset;\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      window.scrollBy({\n        top: targetPosition,\n        left: 0,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport default createCadsGallery;\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport iconXUrl from './img/bi-x-octagon.svg';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport '../src/css/layout/simple-lightbox-window.css';\nimport iconsUrl from '../src/img/icons.svg';\nimport getImages from './js/pixabay-api.js';\nimport createCadsGallery from './js/render-functions.js';\nimport { scrollingDown } from './js/render-functions.js';\n\nconst galleryRef = document.querySelector('.gallery');\nconst loaderRef = document.querySelector('.loader');\nconst searchForm = document.querySelector('.search-form');\nconst moreBtn = document.getElementById('morePageBtn');\n\nmoreBtn.addEventListener('click', onMoreBtnClick);\nmoreBtn.style.display = 'none';\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\n\nlet currentPage = 1;\nlet maxPages = 0;\nlet searchStr = '';\nlet images = [];\n\nlet slBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  nav: true,\n  navText: [\n    `<svg class=\"lightbox-button-icon-prev\" width=\"24\" height=\"24\" aria-label=\"icon arrow left\">\n          <use href=\"${iconsUrl}#icon-chevron-left\"></use>\n        </svg>`,\n    `<svg class=\"lightbox-button-icon-next\" width=\"24\" height=\"24\" aria-label=\"icon arrow right\">\n          <use href=\"${iconsUrl}#icon-chevron-right\"></use>\n        </svg>`,\n  ],\n  close: true,\n  closeText: `\n        <svg class=\"lightbox-close-icon\" width=\"16\" height=\"16\">\n          <use href=\"${iconsUrl}#close-form\"></use>\n        </svg>`,\n  enableKeyboard: true,\n  showCounter: true,\n  animationSlide: true,\n  loop: true,\n});\n\nfunction onSearchFormSubmit(event) {\n  event.preventDefault();\n  searchStr = event.currentTarget.search.value.trim();\n  if (searchStr === '') return;\n\n  reset();\n  loaderRef.style.display = 'block';\n\n  getImages(searchStr, currentPage)\n    .then(data => refreshOnSuccess(data))\n    .catch(msg => refreshOnError(msg))\n    .finally(() => {\n      loaderRef.style.display = 'none';\n      updateMoreBtn();\n    });\n}\n\nfunction refreshOnError(msg) {\n  searchForm.search.value = '';\n  loaderRef.style.display = 'none';\n  createErrMsg(msg);\n  galleryRef.style.backgroundColor = '#f5f5f5';\n  galleryRef.innerHTML = '';\n  slBox.refresh();\n}\n\nfunction refreshOnSuccess(data) {\n  galleryRef.style.backgroundColor = '#ffffff';\n  maxPages = Math.ceil(data.totalHits / 15);\n  images.push(...data.hits);\n  currentPage += 1;\n  createCadsGallery(images, galleryRef);\n  slBox && slBox.refresh();\n  scrollingDown();\n}\n\nfunction createErrMsg(msg) {\n  iziToast.show({\n    message: msg,\n    messageColor: '#fafafb',\n    messageSize: '16px',\n    backgroundColor: '#fc5a5a',\n    position: 'topRight',\n    closeOnEscape: true,\n    close: true,\n    icon: 'Icomoon',\n    iconUrl: `${iconXUrl}`,\n    iconColor: '#fafafb',\n  });\n}\n\nfunction onMoreBtnClick() {\n  loaderRef.style.display = 'block';\n  moreBtn.style.visible = 'none';\n\n  getImages(searchStr, currentPage)\n    .then(data => refreshOnSuccess(data))\n    .catch(msg => refreshOnError(msg))\n    .finally(() => {\n      loaderRef.style.display = 'none';\n      moreBtn.style.visible = 'block';\n      updateMoreBtn();\n    });\n}\n\nfunction updateMoreBtn() {\n  moreBtn.style.display = images.length > 0 ? 'block' : 'none';\n  if (currentPage >= maxPages) {\n    moreBtn.style.display = 'none';\n    if (maxPages > 1) {\n      createErrMsg(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  }\n}\n\nfunction reset() {\n  currentPage = 1;\n  maxPages = 0;\n  images = [];\n}\n"],"names":["iconXUrl","iconsUrl","API_URL","API_KEY","getImages","strForSearch","pageNumber","apiParams","data","axios","error","cardMarkup","card","largeImageURL","previewURL","tags","likes","views","comments","downloads","createCardsMarkup","cards","createCadsGallery","cardsArray","galleryRef","cardsMarkup","scrollingDown","gallery","cardHeight","offset","targetPosition","resolve","loaderRef","searchForm","moreBtn","onMoreBtnClick","onSearchFormSubmit","currentPage","maxPages","searchStr","images","slBox","SimpleLightbox","event","reset","refreshOnSuccess","msg","refreshOnError","updateMoreBtn","createErrMsg","iziToast"],"mappings":"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"}